<div class="widget">
  <div class="graph-widget">
    <div class="body-small">
      Placeholder Identifier | Placeholder Title
    </div>
    <div>
      <svg width="608" height="156"></svg>
    </div>
    <div style="display:flex; flex-direction:row; justify-content: space-between;
                align-self: stretch;">
      <!-- Duration Selection List -->
      <div style="display:flex; flex-direction:row;">
        <input type="radio" id="1w" name="duration">
        <label class="body-small" for="1w">1-Week</label>

        <input type="radio" id="1m" name="duration">
        <label class="body-small" for="1m">1-Month</label>

        <input type="radio" id="6m" name="duration">
        <label class="body-small" for="6m">6-Months</label>

        <input type="radio" id="1y" name="duration">
        <label class="body-small" for="1y">1-Year</label>
      </div>
      <!-- Unit Label -->
      <div class="body-small">
        Hrs/Day
      </div>
    </div>
  </div>
</div>

<script>
    console.log("entered barchart script")
    // Selecting and defining work area in the SVG
    var svg = d3.select("svg"),
        margin = 24,
        width = svg.attr("width"),
        height = svg.attr("height") - margin

    console.log(width)
    console.log(height)

    // Setting X and Y axis ranges
    var xScale = d3.scaleBand().range ([0, width]).padding(0.5),
        yScale = d3.scalePow().range ([height, 0]);

    // Appending a Graph to work with to the SVG
    var g = svg.append("g")

    console.log("csv reading started")
    d3.csv("../static/testdata.csv", function(error, data) {
        if (error) {
            console.log("error occurred")
            throw error;
        }

        xScale.domain(data.map(function(d) { return d.Day; }));
        yScale.domain([0, d3.max(data, function(d) { return d.Hrs; })]);

        var xAxis = g.append("g")
                     .attr("transform", "translate(0," + (height+4) + ")")
                     .call(d3.axisBottom(xScale));

        xAxis.selectAll("line")
            .style("display", "none")

        xAxis.selectAll("path")
            .style("display", "none")

        xAxis.selectAll("text")
            .style("fill", "white")
            .style("font-size", "12px")
            .style("font-family", "Public Sans, sans-serif")

        g.selectAll(".bar")
         .data(data)
         .enter().append("rect")
         .attr("class", "bar")
         .attr("x", function(d) { return xScale(d.Day) + 0.5 * xScale.bandwidth() - 2; })
         .attr("y", function(d) { return yScale(d.Hrs) + margin; })
         .attr("width", 4)
         .attr("rx", 2)
         .attr("height", function(d) { return height - yScale(d.Hrs) - margin; });

        // Get the y axis value on top
        g.selectAll("text.bar")
         .data(data)
         .enter().append("text")
         .style("fill", "white")
         .style("font-size", "12px")
         .style("font-family", "Public Sans, sans-serif")
         .attr("text-color", "white")
         .attr("text-anchor", "middle")
         .attr("fill", "#70747a")
         .attr("x", function(d) { return xScale(d.Day) + 0.5 * xScale.bandwidth(); })
         .attr("y", function(d) { return yScale(d.Hrs) + margin - 12; })
         .text(function(d) { return d.Hrs; });
    });

</script>
