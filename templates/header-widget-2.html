<!-- The HTML itself -->
<div class="widget-container">
    <div id="header-widget-2" class="widget dark">
      <img id="hamburger-icon" src="../static/images/List.svg" />
      <span id="greeting-span-2" class="body-bold">{{page_name}}</span>
      <span id="dark-mode-span">
        <img id="dark-mode-icon" src="../static/images/LightMode.svg" />
      </span>
    </div>
  </div>

  <!-- The JS Code -->
  <script>
    "use strict";

    function setLightMode() {
      localStorage.setItem('dark_mode_on', '0');

      // set icons to the correct color
      $('#dark-mode-icon').attr('src', '../static/images/DarkMode.svg');
      $('.lab-summary-options').attr('src', '../static/images/GearSix_dark.svg');
      $('#hamburger-icon').attr('src', '../static/images/List_dark.svg');

      // change remaining css
      $("body, a").css({"color": "#2A2A2A"});
      $("#dashboard").css({"background": "linear-gradient(29.82deg, #EEEEEE -3.61%, rgba(238, 238, 238, 0.5) 103.96%)"});
      $(".widget").css({"background": "white"});

      // ensure power consump widget stays white
      $(".power-consumption-widget").css({"color": "white"});
    }

    function setDarkMode() {
      localStorage.setItem('dark_mode_on', '1');

      // set icons to the correct color
      $('#dark-mode-icon').attr('src', '../static/images/LightMode.svg');
      $('.lab-summary-options').attr('src', '../static/images/GearSix.svg');
      $('#hamburger-icon').attr('src', '../static/images/List.svg');

      // change remaining css
      $("body, a").css({"color": "white"});
      $("#dashboard").css({"background": "linear-gradient(32.82deg, #2a2a2a -7.28%, rgba(42, 42, 42, 0.75) 107.76%)"});
      $(".widget").css({"background": "#2a2a2a"});
    }

    function toggleDarkMode() {
      // LightMode icon shows in dark mode, and vice versa
      let dark_mode_on = localStorage.getItem('dark_mode_on') ?? '1';
      if (dark_mode_on === '0') setDarkMode();
      else setLightMode();
    }

    function setMenuClosed() {
      localStorage.setItem('menu_open', '0');

      // if dark mode is on, display white svg. else display gray one
      if (localStorage.getItem('dark_mode_on') === '0') {
        $('#hamburger-icon').attr('src', '../static/images/List_dark.svg');
      } else {
        $('#hamburger-icon').attr('src', '../static/images/List.svg');
      }
    }

    function setMenuOpen() {
      localStorage.setItem('menu_open', '1');

      // if dark mode is on, display white svg. else display gray one
      if (localStorage.getItem('dark_mode_on') === '0') $('#hamburger-icon').attr('src', '../static/images/X_dark.svg');
      else $('#hamburger-icon').attr('src', '../static/images/X.svg');
    }

    function toggleMenu() {
      let menu_open = localStorage.getItem('menu_open') ?? '0';
      if (menu_open === '0') setMenuOpen();
      else setMenuClosed();
    }

    function setup() {
        $('#dark-mode-icon').on('click', toggleDarkMode);
        $('#hamburger-icon').on('click', toggleMenu);
        console.log("setup");
    }

    $('document').ready(setup);
  </script>
